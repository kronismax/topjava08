Index: src/main/webapp/WEB-INF/jsp/exception/exception.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/webapp/WEB-INF/jsp/exception/exception.jsp	(revision )
+++ src/main/webapp/WEB-INF/jsp/exception/exception.jsp	(revision )
@@ -0,0 +1,24 @@
+<%@page isErrorPage="true" contentType="text/html" pageEncoding="UTF-8" %>
+<%@ taglib prefix="spring" uri="http://www.springframework.org/tags" %>
+<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
+<html>
+<jsp:include page="../fragments/headTag.jsp"/>
+
+<body>
+<jsp:include page="../fragments/bodyHeader.jsp"/>
+
+<div class="jumbotron">
+    <div class="container">
+        <br>
+        <h4>Application error: </h4>
+        <h2>${exception.message}</h2>
+<!--
+<c:forEach items="${exception.stackTrace}" var="stackTrace">
+    ${stackTrace}
+</c:forEach>
+-->
+    </div>
+</div>
+<jsp:include page="../fragments/footer.jsp"/>
+</body>
+</html>
\ No newline at end of file
Index: src/main/java/ru/javawebinar/topjava/web/GlobalControllerExceptionHandler.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/main/java/ru/javawebinar/topjava/web/GlobalControllerExceptionHandler.java	(revision )
+++ src/main/java/ru/javawebinar/topjava/web/GlobalControllerExceptionHandler.java	(revision )
@@ -0,0 +1,36 @@
+package ru.javawebinar.topjava.web;
+
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+import org.springframework.core.Ordered;
+import org.springframework.core.annotation.Order;
+import org.springframework.web.bind.annotation.ControllerAdvice;
+import org.springframework.web.bind.annotation.ExceptionHandler;
+import org.springframework.web.servlet.ModelAndView;
+import ru.javawebinar.topjava.AuthorizedUser;
+
+import javax.servlet.http.HttpServletRequest;
+
+/**
+ * User: gkislin
+ * Date: 23.09.2014
+ */
+@ControllerAdvice
+public class GlobalControllerExceptionHandler {
+    private static final Logger LOG = LoggerFactory.getLogger(GlobalControllerExceptionHandler.class);
+
+    @ExceptionHandler(Exception.class)
+    @Order(Ordered.LOWEST_PRECEDENCE)
+    ModelAndView defaultErrorHandler(HttpServletRequest req, Exception e) throws Exception {
+        LOG.error("Exception at request " + req.getRequestURL(), e);
+        ModelAndView mav = new ModelAndView("exception/exception");
+        mav.addObject("exception", e);
+
+        // Interceptor is not invoked, put userTo
+        AuthorizedUser authorizedUser = AuthorizedUser.safeGet();
+        if (authorizedUser != null) {
+            mav.addObject("userTo", authorizedUser.getUserTo());
+        }
+        return mav;
+    }
+}
